ì œê³µí•´ì£¼ì‹  ì´ˆì•ˆì„ ë°”íƒ•ìœ¼ë¡œ, **ìµœì‹  ë¡œê·¸ ë°ì´í„°(Epoch 50 ê¸°ì¤€: MAE 1.67, R2 0.98)**ë¥¼ ë°˜ì˜í•˜ê³  ì˜¤íƒ€ ë° ìš©ì–´ë¥¼ ë‹¤ë“¬ì–´ **ì „ë¬¸ì ì¸ ë³´ê³ ì„œ/README í˜•íƒœ**ë¡œ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.

ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

---

# ğŸš— End-to-End Self-Driving Steering Prediction

**ğŸ“‚ ëª¨ë¸ ê²½ë¡œ:** `sungb_workspace\CNN_Model\train\exp2`

## 0. Project Overview (ê°œìš”)
ë³¸ í”„ë¡œì íŠ¸ëŠ” ë‹¨ì¼ ì „ë°© ì¹´ë©”ë¼ ì˜ìƒ(`drive_data.mp4`)ì„ ì…ë ¥ë°›ì•„ **ìë™ì°¨ì˜ ì¡°í–¥ê°(Steering Angle)ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì˜ˆì¸¡í•˜ëŠ” CNN ëª¨ë¸** êµ¬ì¶•ì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

ê¸°ì¡´ì˜ ìˆ˜ë™ ë¼ë²¨ë§ ë¹„ìš©ì„ ì ˆê°í•˜ê¸° ìœ„í•´ **Computer Vision (OpenCV) ê¸°ë°˜ì˜ Auto-Labeling íŒŒì´í”„ë¼ì¸**ì„ ì„¤ê³„í•˜ì—¬ í•™ìŠµ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì°¨ì„ ì„ ì¸ì‹í•˜ê³  ì£¼í–‰ ê²½ë¡œë¥¼ ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•˜ëŠ” End-to-End ììœ¨ì£¼í–‰ ëª¨ë¸ì„ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

---

## 1. Data Preprocessing (ë°ì´í„° ì „ì²˜ë¦¬)

ì£¼í–‰ ì˜ìƒì—ì„œ í”„ë ˆì„ì„ ì¶”ì¶œí•˜ê³ , CNN ëª¨ë¸ í•™ìŠµì— ìµœì í™”ëœ í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ê°€ê³µí–ˆìŠµë‹ˆë‹¤.

### 1.1 Frame Extraction & Auto-Labeling
- **Source**: `drive_data.mp4` (ì „ë°© ì£¼í–‰ ì˜ìƒ)
- **Sampling**: `STRIDE=1` ì„¤ì •ìœ¼ë¡œ ì˜ìƒì˜ **ëª¨ë“  í”„ë ˆì„**ì„ ì†ì‹¤ ì—†ì´ ì¶”ì¶œí•˜ì—¬ ë°ì´í„°ì˜ ì—°ì†ì„±ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.
- **Auto-Labeling (Self-Supervised)**:
  - OpenCVì˜ `Thresholding` ë° `Histogram` ë¶„ì„ì„ í†µí•´ ì°¨ì„  ìœ„ì¹˜ ê²€ì¶œ.
  - ì°¨ì„  ì¤‘ì‹¬ì ê³¼ í™”ë©´ ì¤‘ì•™ì˜ í¸ì°¨ë¥¼ ê³„ì‚°í•˜ì—¬ **ì¡°í–¥ê°(Steering Angle)** ë¼ë²¨ ìë™ ìƒì„±.
  - **Data Cutoff**: ìœ íš¨í•˜ì§€ ì•Šì€ ë°ì´í„°(ì •ì°¨ ì¤‘, ì°¨ì„  ë¯¸ê²€ì¶œ ë“±) ì œê±°ë¥¼ ìœ„í•´ ì•½ 54ì´ˆ ì§€ì ì—ì„œ ë°ì´í„° ìƒì„±ì„ ì¢…ë£Œ.
- **Resizing & ROI**: ì›ë³¸ ì˜ìƒì„ **320x180 (RGB)** í¬ê¸°ë¡œ ë¦¬ì‚¬ì´ì¦ˆí•œ í›„, ëª¨ë¸ ì…ë ¥ ì‹œ í•˜ë‹¨ ë„ë¡œ ì˜ì—­(**60x320**)ë§Œ ì‚¬ìš©í•˜ë„ë¡ ì „ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.

### 1.2 Data Augmentation (ë°ì´í„° ì¦ê°•)
ë°ì´í„° í¸í–¥ì„ ë°©ì§€í•˜ê³  ì¼ë°˜í™” ì„±ëŠ¥ì„ ë†’ì´ê¸° ìœ„í•´ ì¦ê°• ê¸°ë²•ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.
- **Horizontal Flip (ì¢Œìš° ë°˜ì „)**:
  - ì¢Œ/ìš°íšŒì „ ë°ì´í„° ë¶ˆê· í˜• í•´ì†Œë¥¼ ìœ„í•´ ì´ë¯¸ì§€ë¥¼ ì¢Œìš° ë°˜ì „.
  - ë¼ë²¨(ì¡°í–¥ê°) ë˜í•œ ëŒ€ì¹­ ë³€í™˜(`180 - angle`)í•˜ì—¬ ë°ì´í„° ì–‘ì„ **2ë°°ë¡œ ì¦ê°•**í–ˆìŠµë‹ˆë‹¤.

### 1.3 Data Information
- **Image Resolution**: 320x180 (RGB) -> Input: (3, 60, 320)
- **Total Samples**: 2,162 frames (Augmented)
- **Data Directory**: `sungb_workspace/CNN_Model/dataset`

---

## 2. CNN Architecture (ëª¨ë¸ êµ¬ì¡°)

NVIDIA PilotNet ë“± ììœ¨ì£¼í–‰ì— ê²€ì¦ëœ êµ¬ì¡°ë¥¼ ì°¸ê³ í•˜ì—¬, ì„ë² ë””ë“œ í™˜ê²½(ë¼ì¦ˆë² ë¦¬íŒŒì´ ë“±)ì—ì„œë„ ë™ì‘ ê°€ëŠ¥í•œ ê²½ëŸ‰í™” CNNì„ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

### 2.1 Model Layers
**íŠ¹ì§• ì¶”ì¶œ(Feature Extraction)**ì„ ìœ„í•œ 5ê°œì˜ Conv Layerì™€ **íšŒê·€(Regression)**ë¥¼ ìœ„í•œ 4ê°œì˜ FC Layerë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

* **Input**: `(3, 60, 320)` (ROI Crop & Normalized)
* **Convolutional Layers (5 Layers)**:
    1.  `Conv2d(3 â†’ 24, kernel=5, stride=2)` + ReLU
    2.  `Conv2d(24 â†’ 36, kernel=5, stride=2)` + ReLU
    3.  `Conv2d(36 â†’ 48, kernel=5, stride=2)` + ReLU
    4.  `Conv2d(48 â†’ 64, kernel=3)` + ReLU
    5.  `Conv2d(64 â†’ 64, kernel=3)` + ReLU
* **Fully Connected Layers (4 Layers)**:
    * `Flatten` â†’ `Linear(100)` â†’ `Linear(50)` â†’ `Linear(10)` â†’ `Output(1)`

### 2.2 Training Parameters
* **Epochs**: 50 (Loss ìˆ˜ë ´ í™•ì¸)
* **Batch Size**: 32 (Drop Last ì ìš©ìœ¼ë¡œ í•™ìŠµ ì•ˆì •ì„± í™•ë³´)
* **Learning Rate**: `1e-3` (Adam Optimizer)
* **Loss Function**: MSELoss (Mean Squared Error)

---

## 3. Evaluation (í‰ê°€ ë° ê²°ê³¼)

### 3.1 Evaluation Methodology
ë°ì´í„°ì…‹ êµ¬ì¶• í›„ **Train(80%) / Validation(20%)**ìœ¼ë¡œ ë¶„í• í•˜ì—¬ í•™ìŠµ ë° ê²€ì¦ì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. íšŒê·€ ì„±ëŠ¥ í‰ê°€ë¥¼ ìœ„í•´ **MAE(í‰ê·  ì ˆëŒ€ ì˜¤ì°¨)**ì™€ **R2 Score(ê²°ì • ê³„ìˆ˜)**ë¥¼ ì£¼ìš” ì§€í‘œë¡œ í™œìš©í–ˆìŠµë‹ˆë‹¤.

### 3.2 Quantitative Results (ì •ëŸ‰ì  ê²°ê³¼)
*(Epoch 50 ê¸°ì¤€, `log.csv` ë¶„ì„ ê²°ê³¼)*

| Metric | Score | Description |
| :--- | :--- | :--- |
| **MAE (Mean Absolute Error)** | **1.67Â°** | ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œ ì¡°í–¥ê° ê°„ì˜ í‰ê·  ì˜¤ì°¨ê°€ ì•½ 1.6ë„ë¡œ, ë§¤ìš° ì •ë°€í•œ ì œì–´ ì„±ëŠ¥ì„ ë³´ì„. |
| **R2 Score** | **0.986** | 1.0ì— ê°€ê¹Œìš´ ì ìˆ˜ë¡œ, ëª¨ë¸ì´ ì£¼í–‰ ë°ì´í„°ì˜ íŒ¨í„´ì„ 98.6% ì„¤ëª…í•˜ê³  ìˆìŒì„ ì˜ë¯¸í•¨. |
| **Test Loss (MSE)** | **11.71** | ì´ˆê¸° Loss ëŒ€ë¹„ ë¹„ì•½ì ìœ¼ë¡œ ê°ì†Œí•˜ì—¬ ëª¨ë¸ì´ ìµœì í™” ì§€ì ì— ë„ë‹¬í•¨. |

### 3.3 Qualitative Analysis
* **Loss Convergence**: í•™ìŠµ ì´ˆê¸° ë†’ì€ Lossì—ì„œ ì‹œì‘í•˜ì—¬ Epoch 50 ì‹œì ì—ì„œ `MAE 1.67`ê¹Œì§€ ì•ˆì •ì ìœ¼ë¡œ ìˆ˜ë ´í•˜ì˜€ìŠµë‹ˆë‹¤.
* **Inference**: ì‹¤ì œ ì£¼í–‰ ì˜ìƒ ì¶”ë¡  ê²°ê³¼, ì§ì„  ì£¼í–‰ì˜ ì•ˆì •ì„±ë¿ë§Œ ì•„ë‹ˆë¼ ê³¡ì„  êµ¬ê°„ì—ì„œë„ ì°¨ì„ ì„ ì´íƒˆí•˜ì§€ ì•Šê³  ë¶€ë“œëŸ¬ìš´ ì¡°í–¥ê°ì„ ì˜ˆì¸¡í•¨ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.
* **Result Video**: `sungb_workspace\CNN_Model\inference\exp2\result.mp4`

---

Â© 2025 Autonomous Driving Project.